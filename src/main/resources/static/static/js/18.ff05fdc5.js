(window.webpackJsonp=window.webpackJsonp||[]).push([[18],{746:
/*!*******************************************************************!*\
  !*** ../node_modules/@gdjiami/gzb-jssdk/dist/gzb-jssdk.module.js ***!
  \*******************************************************************/
/*! exports provided: Api, BridgeResponseError, DesktopApi, Device, DeviceDector, EventEmitter, CustomEvent, MobileApi, Utils, VERSION, RPC, RPCError, api, DialogType, NativeMenuItem, default */
/*! all exports used */
/*! ModuleConcatenation bailout: Module is referenced from these modules with unsupported syntax: ./js/components/FilePreview/index.tsx (referenced with import()), ./js/containers/LicenseDetails/ForApp.tsx (referenced with import()) */function(e,t,n){"use strict";n.r(t),n.d(t,"Api",function(){return D}),n.d(t,"BridgeResponseError",function(){return b}),n.d(t,"DesktopApi",function(){return V}),n.d(t,"Device",function(){return w}),n.d(t,"DeviceDector",function(){return y}),n.d(t,"EventEmitter",function(){return B}),n.d(t,"CustomEvent",function(){return m}),n.d(t,"MobileApi",function(){return P}),n.d(t,"Utils",function(){return p}),n.d(t,"VERSION",function(){return J}),n.d(t,"RPC",function(){return x}),n.d(t,"RPCError",function(){return S}),n.d(t,"api",function(){return R}),n.d(t,"DialogType",function(){return T}),n.d(t,"NativeMenuItem",function(){return A});var r=n(/*! tslib */2);function i(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t]}function o(e,t,n){if(i("[GZB JSSDK deprecated]: "+e),t)return function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return t.apply(n,e)}}function a(){}function s(e){return e}function c(e){return""+e.substr(0,1).toUpperCase()+e.substr(1)}function u(e,t){if(void 0===t&&(t=!1),!(e instanceof Date)){if("string"==typeof e){var n=new Date(e);if(Number.isNaN(n.getTime())){var r=Number.parseInt(e);if(Number.isNaN(r))throw new TypeError(e+" is not a valid Date");return t?new Date(1e3*r):new Date(r)}return n}return t?new Date(1e3*e):new Date(e)}return e}function l(e,t){return e<72.004||t>137.8347||(e<.8293||t>55.8271)}function d(e,t,n){void 0===n&&(n=0);var r=null==e?0:e.length;if(!r)return-1;return void 0!==n&&(n<0?Math.max(r+n,0):Math.min(n,r-1)),function(e,t,n,r){for(var i=e.length,o=n+(r?1:-1);r?o--:++o<i;)if(t(e[o],o,e))return o;return-1}(e,t,n,!1)}var p=Object.freeze({bigStringTransform:function e(t){if(null==t)return t;if("string"==typeof t)return t.length>2e3?t.substr(0,2e3)+"...":t;if(Array.isArray(t))return t.map(e);if("object"==typeof t){var n={};for(var r in t)t.hasOwnProperty(r)&&(n[r]=e(t[r]));return n}return t},debug:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t]},warn:i,deprecated:o,noop:a,identity:s,upperFirst:c,parseDate:u,dateFormat:function(e,t,n){void 0===e&&(e=new Date),void 0===t&&(t="YYYY-MM-DD"),void 0===n&&(n=!1);var r=u(e,n),i=r.getFullYear(),o=r.getMonth()+1,a=r.getDate(),s=r.getHours(),c=s<=12?s:s-12,l=r.getMinutes(),d=r.getSeconds(),p={YYYY:i,MM:("0"+o).slice(-2),M:o,DD:("0"+a).slice(-2),D:a,H:s,HH:("0"+s).slice(-2),h:c,hh:("0"+c).slice(-2),m:l,mm:("0"+l).slice(-2),s:d,ss:("0"+d).slice(-2)};return t.replace(/Y+|M+|D+|H+|h+|m+|s+/g,function(e){return p[e]})},outOfChina:l,findIndex:d}),f=0,h={beforeSend:function(e){return e?JSON.stringify(e):void 0},afterReceived:s,preserveName:!1},g=function(){function e(){this.listeners={},this.responseCallbacks={},void 0===window.HandleEvent&&console.warn("[Window Bridge] 初始化异常，window.HandleEvent 为undefined. 这可能说明SDK运行在没有Bridge的环境\n        请使用Device.bridgeAvailable()来判断当前环境是否支持。\n        ")}return e.getInstance=function(){return null==this.instance?this.instance=new e:this.instance},e.getNormalizedBridge=function(){var e=this.getInstance();return null==this.normalizedBridge?this.normalizedBridge={callHandler:function(t,n,r){e.emit("[s]"+t,n,r)},registerHandler:function(t,n){e.addListener("[c]"+t,n)}}:this.normalizedBridge},e.prototype.emit=function(e,t,n){var r=this,i=this.listeners[e];if(!i||!i.length)throw new Error("[Windows Bridge]: "+e+" not registered(PC 端未支持该接口)");i.forEach(function(e){return e.call(r,t,n)})},e.prototype.addListener=function(e,t){var n=this,r=this.listeners[e]||[];return this.listeners[e]=r.concat(t),function(){n.removeListener(e,t)}},e.prototype.removeListener=function(e,t){var n=this.listeners[e];if(n&&n.length){var r=n.indexOf(t);-1!==r&&n.splice(r,1)}},e.prototype.addCallback=function(e,t,n){return void 0===n&&(n="cb_"+e+"_"+f++),this.responseCallbacks[n]=t,n},e.prototype.callCallback=function(e,t){var n=this.responseCallbacks[e];n&&n(t),delete this.responseCallbacks[e]},e.prototype.registerHandler=function(e,t){var n=this;void 0===t&&(t={});var i=Object(r.a)({},h,t);return this.registerBridgeHandler(e,function(t,r){var o;"function"==typeof r&&(o=n.addCallback(e,function(e){r(i.afterReceived(e))}));var a=i.bridgeHandleName||(i.preserveName?e:"On"+c(e)),s=i.beforeSend(t);window.HandleEvent(a,s,o)}),this},e.prototype.deprecatedRegisterHandler=function(e,t){return this.registerBridgeHandler.call(this,e,t),this},e.prototype.callClientHandler=function(e,t,n){this.emit("[c]"+e,t,n)},e.prototype.registerBridgeHandler=function(e,t){this.addListener("[s]"+e,t)},e}();window.exeCallback=function(e,t){g.getInstance().callCallback(t,e)};var v=function(){function e(){this.androidBridgeInitialized=!1}return e.getInstance=function(){return this.instance?this.instance:this.instance=new e},e.prototype.setUpBridge=function(e){var t,n=this;if(t=function(t){var n=Object(r.a)({},t),i=t.callHandler;n.callHandler=function(e,t,n){return i(e,t,function(e){e&&"string"==typeof e&&(e=JSON.parse(e)),"function"==typeof n&&n(e)})},e(n)},window.WebViewJavascriptBridge)void 0===window.WebViewJavascriptBridge.init&&(window.WebViewJavascriptBridge.init=a),!this.androidBridgeInitialized&&w.android()&&(window.WebViewJavascriptBridge.init(),this.androidBridgeInitialized=!0),t(window.WebViewJavascriptBridge);else if(window.WVJBCallbacks)window.WVJBCallbacks.push(t);else if(window.WVJBCallbacks=[t],w.android())document.addEventListener("WebViewJavascriptBridgeReady",function(){"function"==typeof window.WebViewJavascriptBridge.init&&(window.WebViewJavascriptBridge.init(),n.androidBridgeInitialized=!0);var e=window.WVJBCallbacks;delete window.WVJBCallbacks,e.forEach(function(e){e(window.WebViewJavascriptBridge)})},!1);else{var i=document.createElement("iframe");i.style.display="none",i.src="https://__bridge_loaded__",document.documentElement.appendChild(i),setTimeout(function(){document.documentElement.removeChild(i)},0)}},e}(),b=function(e){function t(n,r){var i=e.call(this,r)||this;return i.errCode=n,Object.setPrototypeOf(i,t.prototype),i}return Object(r.d)(t,e),t}(Error),y=function(){function e(){this.initializeUserAgent()}return e.prototype.webkit=function(){return this.find("applewebkit")},e.prototype.bridgeAvailable=function(){var e=this;return new Promise(function(t){if(null!=e.isBridgeAvailable)return t(e.isBridgeAvailable);if(e.windows())return t(e.isBridgeAvailable=null!=window.HandleEvent);if(e.mobile())if(null!=window.WebViewJavascriptBridge)t(e.isBridgeAvailable=!0);else{var n=!1;v.getInstance().setUpBridge(function(){t(e.isBridgeAvailable=n=!0)}),setTimeout(function(){n||(n=!0,t(e.isBridgeAvailable=!1))},1500)}})},e.prototype.windows=function(){return this.find("windows")},e.prototype.windowsPhone=function(){return this.windows()&&this.find("phone")},e.prototype.windowsTablet=function(){return this.windows()&&!this.find("phone")&&this.find("touch")},e.prototype.iphone=function(){return!this.windows()&&this.find("iphone")},e.prototype.ipad=function(){return this.find("ipad")},e.prototype.ipod=function(){return this.find("ipod")},e.prototype.ios=function(){return this.iphone()||this.ipad()||this.ipod()},e.prototype.android=function(){return!this.windows()&&this.find("android")},e.prototype.androidPhone=function(){return this.android()&&this.find("mobile")},e.prototype.androidTablet=function(){return this.android()&&!this.find("mobile")},e.prototype.blackberry=function(){return this.find("blackberry")||this.find("bb10")||this.find("rim")},e.prototype.blackberryPhone=function(){return this.blackberry()&&!this.find("tablet")},e.prototype.blackberryTablet=function(){return this.blackberry()&&this.find("tablet")},e.prototype.mobile=function(){return this.androidPhone()||this.iphone()||this.ipod()||this.windowsPhone()||this.blackberryPhone()},e.prototype.tablet=function(){return this.ipad()||this.androidTablet()||this.blackberryTablet()||this.windowsTablet()},e.prototype.desktop=function(){return!this.mobile()&&!this.tablet()},e.prototype.portrait=function(){return window.innerHeight/window.innerWidth>1},e.prototype.landscape=function(){return!this.portrait()},e.prototype.setUserAgent=function(e){this.userAgent=e},e.prototype.initializeUserAgent=function(){this.userAgent=window.navigator.userAgent.toLowerCase()},e.prototype.find=function(e){return-1!==this.userAgent.indexOf(e)},e}(),w=new y,m=function(){function e(e,t){this.cancelable=!1,this.timeStamp=Date.now(),this.eventPrevented=!1,this.type=e,t&&(this.cancelable=t.cancelable||!1)}return Object.defineProperty(e.prototype,"defaultPrevented",{get:function(){return this.eventPrevented},enumerable:!0,configurable:!0}),e.prototype.preventDefault=function(){this.cancelable&&(this.eventPrevented=!0)},e}(),B=function(){function e(){this.listeners={}}return e.prototype.addListener=function(e,t,n,r){var i=this;void 0===r&&(r=!1);var o=this.listeners[e]||[],a={callback:t,context:n,once:r};return this.listeners[e]=o.concat(a),function(){return i.removeListener(e,t)}},e.prototype.once=function(e,t,n){return this.addListener(e,t,n,!0)},e.prototype.getListenerLength=function(e){return this.listeners[e]?this.listeners[e].length:0},e.prototype.removeAllListener=function(e){var t=(this.listeners[e]||[]).length;return delete this.listeners[e],t},e.prototype.removeListener=function(e,t,n){var r=this.listeners[e];if(r&&r.length){var i=d(r,function(e){var r=e.callback,i=e.context;return r===t&&i===n});if(-1!==i)return r.splice(i,1),!0}return!1},e.prototype.emit=function(e,t){var n=this.listeners[e],i=[];if(n&&n.length)for(var o=Object(r.j)(n),a=!1,s=0;s<o.length;s++){var c=o[s],u=c.callback,l=c.context;if(c.once&&this.removeListener(e,u,l),a)i.push(void 0);else{var d=u.call(l,t);!1===d&&(a=!0),i.push(d)}}return i},e}(),k="exitWebApp",H="ready",C=Object.freeze({beforeunload:"beforeunload",beforegoback:"beforegoback",ready:H}),W={hideMoreBtn:!1,left:["close","goback"],onlyCallBack:[],gobackUrl:"",right:""},O={enableHighAccuracy:!0,preferNative:!0,timeout:1/0,watch:!1,maximumAge:0},U={quality:100,targetType:"default",extType:[],maxSizeKb:0},L={multiple:!0},I=0;function E(e){return"string"==typeof e?JSON.parse(e):e}function M(e,t){return"'"+e+"' 方法已经废弃, 请使用 "+t+" 方法代替."}function N(e){o(e+" 方法: 回调形式的API调用已经废弃， 请使用Promise来获取返回值和捕获错误")}var T,A,D=function(e){function t(){var t=e.call(this)||this;return t.menuItems={},t.isReady=!1,t.exit=function(){t.setUpBridge(function(e){e.callHandler(k,void 0)})},setTimeout(function(){t.setupEventWatchers(),w.bridgeAvailable().then(function(){var e=new m(H);t.emit(H,e),t.isReady=!0,t.innerAddEventListener("__addListener__",function(n){n===H&&t.emit(H,e)})})},0),t}return Object(r.d)(t,e),t.prototype.addListener=function(t,n,r){var i=this;return setTimeout(function(){i.emit("__addListener__",{eventType:t})},0),e.prototype.addListener.call(this,t,n,r)},t.prototype.removeListener=function(t,n,r){var i=this,o=e.prototype.removeListener.call(this,t,n,r);return o&&setTimeout(function(){i.emit("__removeListener__",{eventType:t,count:1})},0),o},t.prototype.removeAllListener=function(t){var n=this,r=e.prototype.removeAllListener.call(this,t);return r&&setTimeout(function(){n.emit("__removeListener__",{eventType:t,count:r})},0),r},t.prototype.setTitle=function(e){var t=this;w.bridgeAvailable().then(function(n){n?t.setUpBridge(function(t){t.callHandler("setWebTitle",{title:e})}):document.title=e})},t.prototype.phone=function(e){this.setUpBridge(function(t){t.callHandler("makeCallToNumber",{callNumber:e})})},t.prototype.sms=function(e){this.setUpBridge(function(t){t.callHandler("sendSmsToNumber",{callNumber:e})})},t.prototype.mail=function(e){var t=this;w.bridgeAvailable().then(function(n){if(n)t.setUpBridge(function(t){t.callHandler("openMail",{email:e})});else{var r=document.createElement("a");r.href="mailto:"+e,r.click()}})},t.prototype.locationTo=function(e){var t=this;w.bridgeAvailable().then(function(n){var i="string"==typeof e?{url:e,showMode:"outer"}:Object(r.a)({showMode:"outer"},e);n?t.setUpBridge(function(e){e.callHandler("openUrl",i)}):"outer"===i.showMode?window.open(i.url):location.href=i.url})},t.prototype.url=function(e){return o(M("url","locationTo"),this.locationTo,this)(e)},t.prototype.showContact=function(e){this.setUpBridge(function(t){t.callHandler("openContactItem",{id:e})})},t.prototype.openContact=function(e){this.showContact(e)},t.prototype.selectContact=function(e,t){var n=this,i=Object(r.a)({user:[],type:"multiple",unselect:!0,limit:10},e);return new Promise(function(e,r){n.setUpBridge(function(n){n.callHandler("openContact",i,function(n){try{var i=E(n);"function"==typeof t&&(N("selectContact"),t(i)),e(i)}catch(e){r(e)}})})})},t.prototype.setBarColor=function(e){this.setUpBridge(function(t){t.callHandler("setBarColor",{color:e})})},t.prototype.setBarVisible=function(e){this.setUpBridge(function(t){t.callHandler("showBar",{flag:!e})})},t.prototype.showBar=function(e){w.windows()?this.setUpBridge(function(e){e.callHandler("showMenu",null)}):this.setBarVisible(!e||!0)},t.prototype.hideBar=function(){this.setBarVisible(!1)},t.prototype.settingBar=function(e,t){o("settingBar 已经废弃");var n=Object(r.a)({},W,e);this.setUpBridge(function(e){e.callHandler("setBar",Object(r.a)({},n,{hideMoreBtn:n.hideMoreBtn.toString()}),function(e){var n=E(e);"function"==typeof t&&t(n)})})},t.prototype.exitApp=function(){return o(M("exitApp","exit"),this.exit,this)()},t.prototype.date=function(){o("date() 方法已废弃， 请使用客户端日期组件代替")},t.prototype.getLocation=function(e,t){var n=this,i="function"==typeof e||null==e?O:Object(r.a)({},O,e),o="function"==typeof e?e:t;return new Promise(function(e,t){i.preferNative?(delete i.preferNative,n.setUpBridge(function(n){n.callHandler("getLocation",i,function(n){try{var r=E(n)[0],i=r.address,a=r.coordType,s=parseFloat(r.latitude),c=parseFloat(r.longitude),u=parseFloat(r.speed),d={latitude:s,longitude:c,address:i,speed:u=1e3*u/3600,accuracy:parseFloat(r.accuracy),coordType:"bd09ll"===a?"BD09":l(s,c)?"WGS84":"BD09"};"function"==typeof o&&(N("getLocation"),o(d)),e(d)}catch(e){t(e)}})})):navigator.geolocation.getCurrentPosition(function(t){var n=t.coords,r={latitude:n.latitude,longitude:n.longitude,accuracy:n.accuracy,speed:n.speed,coordType:"WGS84"};"function"==typeof o&&o(r),e(r)},function(e){var n=e.code,r=e.message;t(new b(n,r))},i)})},t.prototype.getLoc=function(e){o(M("getLoc","getLocation"),this.getLocation,this)(e)},t.prototype.geoNavigate=function(e,t){this.setUpBridge(function(n){var r={to:t,from:e,coordType:"WGS84"};n.callHandler("geoNavigate",r)})},t.prototype.apiInfos=function(e){var t=this;return new Promise(function(n,r){t.setUpBridge(function(t){t.callHandler("apiList",null,function(t){try{var i=E(t);"function"==typeof e&&(N("apiInfos"),e(i)),n({platform:i.plat,version:i.version,API:i.apilist})}catch(e){r(e)}})})})},t.prototype.getList=function(e){o(M("getList","apiInfos"),this.apiInfos,this)(e)},t.prototype.scanQRCode=function(e,t){var n=this,r="boolean"!=typeof e||e,i="function"==typeof e?e:t;return new Promise(function(e,t){n.setUpBridge(function(n){n.callHandler("scanQRCode",{needResult:r},function(n){try{var r=E(n);"function"==typeof i&&(N("scanQRCode"),i(r)),e(r)}catch(e){t(e)}})})})},t.prototype.QRcode=function(e,t){o(M("QRcode","scanQRCode"),this.scanQRCode)(e,t)},t.prototype.shareTo=function(){this.setUpBridge(function(e){e.callHandler("shareTo",null)})},t.prototype.openDialog=function(e){this.setUpBridge(function(t){t.callHandler("openDialog",e)})},t.prototype.Dialog=function(e,t){var n="object"==typeof e?e:{type:e,id:t};o(M("Dialog","openDialog"),this.openDialog)(n)},t.prototype.chooseImg=function(e,t){var n=this,i=null==e||"function"==typeof e?U:Object(r.a)({},U,e),o="function"==typeof e?e:t;return new Promise(function(e,t){n.setUpBridge(function(n){n.callHandler("chooseImg",i,function(n){try{var r=E(n);if("function"==typeof o&&(N("chooseImg"),o(r)),"true"===r.result){var i=r.imgData,a=r.imgHeight,s=r.imgWidth,c=r.imgType,u=r.quality;e({dataUrl:i,width:s,height:a,extension:c,quality:u})}else{var l=new b(r.errCode,r.errMsg);t(l)}}catch(e){t(e)}})})})},t.prototype.previewImg=function(e){var t=this;return new Promise(function(n,r){t.setUpBridge(function(t){t.callHandler("previewImg",e,function(e){try{var t=E(e);"true"===t.result?n():r(new b(t.errCode,t.errMsg))}catch(e){r(e)}})})})},t.prototype.openFile=function(e){var t=this;return new Promise(function(n,r){w.bridgeAvailable().then(function(i){i&&w.windows()?t.setUpBridge(function(t){t.callHandler("openFile",{url:e},function(e){var t=E(e);("boolean"==typeof t.result?t.result:"true"===t.result)?n():r(new b(t.errCode,t.errMsg))})}):(window.open(e),n())})})},t.prototype.openVideo=function(e,t){this.setUpBridge(function(n){n.callHandler("openVideo",{url:e,extType:t})})},t.prototype.addMenuItem=function(e,t){this.addNativeMenuItem({id:String(I++),title:e},t)},t.prototype.removeMenuItem=function(e){var t=this;e in this.menuItems&&this.setUpBridge(function(n){n.callHandler("removeMenuItem",{ids:[t.menuItems[e]]}),delete t.menuItems[e]})},t.prototype.setNativeMenuItem=function(e){this.setUpBridge(function(t){t.callHandler("setNativeMenuItem",e)})},t.prototype.selectSession=function(e,t){var n=this,i=null==e||"function"==typeof e?L:Object(r.a)({},L,e),o="function"==typeof e?e:t;return new Promise(function(e,t){n.setUpBridge(function(n){n.callHandler("selectSession",i,function(n){try{var r=E(n);if("function"==typeof o&&(N("SelectSession"),o(r)),"true"===r.result)e(r.session);else{var i=new b(r.errCode,r.errMsg);t(i)}}catch(e){t(e)}})})})},t.prototype.getLanguage=function(e){var t=this;return new Promise(function(n,r){t.setUpBridge(function(t){t.callHandler("getLanguage",null,function(t){try{var i=E(t);if("function"==typeof e&&(N("getLanguage"),e(i)),"true"===i.result)n(i.language);else{var o=new b(i.errCode,i.errMsg);r(o)}}catch(e){r(e)}})})})},t.prototype.goback=function(){var e=this,t=window.location.href;window.history.go(-1),setTimeout(function(){window.location.href===t&&e.exit()},500)},t.prototype.teardown=function(){this.teardownEventWatchers()},t.prototype.addNativeMenuItem=function(e,t){var n=this,r=e.id,i=e.title;this.setUpBridge(function(o){n.menuItems[i]=r,o.callHandler("addMenuItem",e,function(r){var o=E(r);"true"===o.result?(t(null),i in n.menuItems&&n.addNativeMenuItem(e,t)):t(new b(o.errCode,o.errMsg))})})},t.prototype.setupEventWatchers=function(){this.setupBeforeUnloadWatcher(),this.setupBeforeGoBackWatcher()},t.prototype.teardownEventWatchers=function(){this.teardownBeforeUnloadWatcher(),this.teardownBeforeGoBackWatcher()},t.prototype.innerAddEventListener=function(t,n){return e.prototype.addListener.call(this,t,n)},t.prototype.setupBeforeGoBackWatcher=function(){var e=this;this.setupEventWatcher("beforegoback",function(){var t=new m("beforegoback",{cancelable:!0}),n=e.emit("beforegoback",t);t.defaultPrevented||n.some(function(e){return!1===e})||e.goback()})},t.prototype.teardownBeforeGoBackWatcher=function(){this.teardownEventWatcher("beforegoback")},t.prototype.teardownBeforeUnloadWatcher=function(){this.teardownEventWatcher("beforeunload")},t.prototype.setupBeforeUnloadWatcher=function(){var e=this;this.setupEventWatcher("beforeunload",function(){var t=new m("beforeunload",{cancelable:!0}),n=e.emit("beforeunload",t);if(function(e){return e.some(function(e){return!1===e||"string"==typeof e&&""!==e})}(n)||t.defaultPrevented){var r=function(e){return e.find(function(e){return"string"==typeof e&&""!==e})}(n)||t.returnValue;r&&window.confirm(r)&&e.exit()}else e.exit()})},t}(B),_={hideMoreBtn:!1,left:["goback","close"],onlyCallBack:[],gobackUrl:"",right:""},P=function(e){function t(){var t=e.call(this)||this;return t.listenerCount={beforegoback:0,beforeunload:0},t.setBarOptions=Object(r.a)({},_,{left:["goback","close"],onlyCallBack:[]}),t.mobileBridge=v.getInstance(),t}return Object(r.d)(t,e),t.getInstance=function(){return null==this.instance?this.instance=new t:this.instance},t.prototype.getBackButtonVisible=function(){return-1!==this.setBarOptions.left.indexOf("goback")},t.prototype.getCloseButtonVisible=function(){return-1!==this.setBarOptions.left.indexOf("close")},t.prototype.getMoreButtonVisible=function(){return!this.setBarOptions.hideMoreBtn},t.prototype.setMoreButtonVisible=function(e){void 0===e&&(e=!0),this.setBarOptions.hideMoreBtn=!e,this.setupBarWatcher()},t.prototype.setBackButtonVisible=function(e){void 0===e&&(e=!0),this.setBarButtonVisible(e,"goback")},t.prototype.setCloseButtonVisible=function(e){void 0===e&&(e=!0),this.setBarButtonVisible(e,"close")},t.prototype.setupEventWatcher=function(e,t){switch(e){case"beforeunload":this.setUpBeforeUnloadWatcher(t);break;case"beforegoback":this.setUpGobackWatcher(t);break;default:throw new Error("未知事件: "+e)}},t.prototype.teardownEventWatcher=function(e){switch(e){case"beforeunload":case"beforegoback":this._teardownBeforeUnloadWatcher();break;default:throw new Error("未知事件: "+e)}},t.prototype.setUpBridge=function(e){this.mobileBridge.setUpBridge(e)},t.prototype.setBarButtonVisible=function(e,t){var n=this.setBarOptions.left.indexOf(t);e&&-1===n?(this.setBarOptions.left.push(t),this.setupBarWatcher()):e||-1===n||(this.setBarOptions.left.splice(n,1),this.setupBarWatcher())},t.prototype.checkBarWatcher=function(e,t){if(this.listenerCount[t]&&-1!==this.setBarOptions.left.indexOf(e))-1===this.setBarOptions.onlyCallBack.indexOf(e)&&this.setBarOptions.onlyCallBack.push(e);else{var n=this.setBarOptions.onlyCallBack.indexOf(e);-1!==n&&this.setBarOptions.onlyCallBack.splice(n,1)}},t.prototype.setupBarWatcher=function(){var e=this;this.checkBarWatcher("goback","beforegoback"),this.checkBarWatcher("close","beforeunload"),this.setUpBridge(function(t){t.callHandler("setBar",Object(r.a)({},e.setBarOptions,{hideMoreBtn:e.setBarOptions.hideMoreBtn.toString()}),function(t){if(setTimeout(function(){e.setupBarWatcher()},0),"true"===t.result){var n="close"===t.buttonId?e.closeCallback:"goback"===t.buttonId?e.gobackCallback:null;n&&n()}})})},t.prototype._teardownBeforeUnloadWatcher=function(){this.setUpBridge(function(e){e.callHandler("setBar",Object(r.a)({},_,{hideMoreBtn:"false"}))})},t.prototype.watchListener=function(e){var t=this;this.innerAddEventListener("__addListener__",function(n){n.eventType===C[e]&&(t.listenerCount[e]++,t.setupBarWatcher())}),this.innerAddEventListener("__removeListener__",function(n){var r=n.eventType,i=n.count;r===C[e]&&(t.listenerCount[e]-=i,t.setupBarWatcher())}),(this.listenerCount[e]=this.getListenerLength(e))&&setTimeout(function(){t.setupBarWatcher()})},t.prototype.setUpBeforeUnloadWatcher=function(e){this.closeCallback=e,this.watchListener("beforeunload")},t.prototype.setUpGobackWatcher=function(e){this.gobackCallback=e,this.watchListener("beforegoback")},t}(D),V=function(e){function t(){var t=e.call(this)||this;return t.eventDesc={},t.prepareEventWatcher=function(e,n,r){var i=t.eventDesc[e]={count:0,callback:n,nativeEventName:r,eventName:e};t.innerAddEventListener("__addListener__",function(n){n.eventType===e&&(0===i.count&&t.setUpHandler(i.nativeEventName,i.callback),i.count++)}),t.innerAddEventListener("__removeListener__",function(n){var r=n.eventType,o=n.count;r===e&&(i.count-=o,0===i.count&&t.tearDownHandler(i.nativeEventName))})},t.setUpHandler=function(e,n){t.setUpBridge(function(r){r.callHandler(e,null,function(){n(),t.setUpHandler(e,n)})})},t.tearDownHandler=function(e){t.setUpBridge(function(t){t.callHandler(e,null)})},t.initializeBridge(),t}return Object(r.d)(t,e),t.getInstance=function(){return null==this.instance?this.instance=new t:this.instance},t.prototype.setUpBridge=function(e){e(this.bridge)},t.prototype.setupEventWatcher=function(e,t){switch(e){case"beforeunload":this.prepareEventWatcher(e,t,"windowClose");break;case"beforegoback":this.prepareEventWatcher(e,t,"pgGoBack");break;default:throw new Error("未知事件: "+e)}},t.prototype.teardownEventWatcher=function(e){switch(e){case"beforeunload":case"beforegoback":this.tearDownHandler(this.eventDesc[e].nativeEventName),delete this.eventDesc[e];break;default:throw new Error("未知事件: "+e)}},t.prototype.initializeBridge=function(){this.bridge=g.getNormalizedBridge(),g.getInstance().registerHandler("setWebTitle",{beforeSend:function(e){return e.title}}).registerHandler("chooseImg").registerHandler("makeCallToNumber",{beforeSend:function(e){return e.callNumber}}).registerHandler("openMail",{beforeSend:function(e){return e.email}}).deprecatedRegisterHandler("openUrl",function(e){window.HandleEvent("On"+c("openUrl"),e.url,JSON.stringify(e))}).registerHandler("openContactItem",{beforeSend:function(e){return e.id}}).registerHandler("showMenu").registerHandler(k,{preserveName:!0}).registerHandler("apiList",{bridgeHandleName:"OnGetApiList"}).registerHandler("openDialog").registerHandler("openContact").registerHandler("selectSession").registerHandler("getLanguage").registerHandler("windowClose").registerHandler("pgGoBack").registerHandler("previewImg").registerHandler("openFile").registerHandler("addMenuItem").registerHandler("removeMenuItem").registerHandler("setNativeMenuItem").registerHandler("getEnvironment").registerHandler("openVideo")},t}(D),j="rpc",S=function(e){function t(n,r,i){var o=e.call(this,r)||this;return o.code=n,o.error=i,Object.setPrototypeOf(o,t.prototype),o}return Object(r.d)(t,e),t}(Error),x=function(){function e(){this.uid=0,w.mobile()?this.bridge=v.getInstance():(this.bridge={setUpBridge:function(e){e(g.getNormalizedBridge())}},g.getInstance().registerHandler(j))}return e.getInstance=function(){return this.instance?this.instance:this.instance=new e},e.prototype.raw=function(e,t){return Object(r.b)(this,void 0,void 0,function(){var n=this;return Object(r.e)(this,function(r){return[2,new Promise(function(r,i){n.bridge.setUpBridge(function(n){var o="id"in e?function(t){try{if(t){var n=void 0;if(!("id"in(n="string"==typeof t?JSON.parse(t):t))||n.id!==e.id)return void i(new S(0,"协议错误：id为空或不匹配"));r(n)}else i(new S(0,"协议错误：响应为空"))}catch(e){i(new S(0,"协议错误: JSON解析失败("+e.message+")"))}}:"function"==typeof t?t:void 0;n.callHandler(j,e,o),null==o&&r()})})]})})},e.prototype.request=function(e,t){return Object(r.b)(this,void 0,void 0,function(){var n,i,o;return Object(r.e)(this,function(r){switch(r.label){case 0:return n=""+Date.now()+this.uid++,i={jsonrpc:"2.0",id:n,method:e,params:t},[4,this.raw(i)];case 1:if(o=r.sent(),this.isError(o))throw new S(o.error.code,o.error.message,o.error);return[2,o.result]}})})},e.prototype.isError=function(e){return"error"in e},e.prototype.addListener=function(e,t,n){var r={jsonrpc:"2.0",method:e,params:n};this.raw(r,t)},e.prototype.emit=function(e,t){var n={jsonrpc:"2.0",method:e,params:t};this.raw(n)},e}();!function(e){e[e.GroupChat=1]="GroupChat",e[e.Chat=2]="Chat",e[e.Announcement=3]="Announcement",e[e.Visitor=4]="Visitor"}(T||(T={})),function(e){e.refresh="refresh",e.share="share",e.copyLink="copyLink",e.openWithBrowser="openWithBrowser"}(A||(A={}));var J="1.2.1";function R(){return(w.mobile()?P:V).getInstance()}t.default=R}}]);
//# sourceMappingURL=18.ff05fdc5.js.map